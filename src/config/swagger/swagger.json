{
  "swagger": "2.0",
  "info": {
      "version": "1.0.0",
      "title": "Blog Post API",
      "description": "This is Post Share application. You can register, login and share post in system. You can display to posts of users you followed.",
      "contact":{  
         "email":"berkayc78@gmail.com"
      }
  },
  "host": "localhost:8080",
  "basePath": "/api",
  "tags": [
      {
          "name": "Authentication",
          "description": "API to manage login and registration operations."
      },
      {
          "name": "Users",
          "description": "API to manage relations between Users."
      },
      {
          "name": "Posts",
          "description": "API to manage share and display Post."
      }
  ],
  "schemes": [
    "http",
    "https"
  ],
  "consumes": [
    "application/json"
  ],
  "produces": [
    "application/json"
  ],
  "paths": {
    "/auth/register": {
        "put": {
            "operationId":"registerUser",
            "tags": ["Authentication"],
            "summary":"Create new user in system",
            "parameters":[
                {
                    "name": "Register User",
                    "in": "body",
                    "description": "User that will be created",
                    "schema": {
                        "type":"Object",
                        "properties":{
                            "User":{
                                "$ref": "#/definitions/UserToRegister"
                            }
                        }
                        
                    }
            }],
            "responses": {
                "200": {
                    "description": "User was succesfully created but token could not be generated."
                },
                "201": {
                    "description": "User was succesfully created.",
                    "headers":{  
                        "Authorization":{
                            "type":"string",
                            "format":"Bearer",
                            "description":"token of authenticated user with format like 'Bearer xxxxx'"
                        }
                    }
                },
                "400": {
                    "description": "User could not be created.",
                    "schema":{
                      "$ref":"#/definitions/ApiErrorResponse"
                    }   
                }
            }
        }
    },
    "/auth/login": {
        "post": {
            "operationId":"loginUser",
            "tags": ["Authentication"],
            "summary":"Login system and get token in header",
            "parameters":[
                {
                    "name": "Login User",
                    "in": "body",
                    "description": "Credentials that will be login to system.",
                    "schema": {
                        "type":"Object",
                        "properties":{
                            "Credentials":{
                                "$ref": "#/definitions/Credentials"
                            }
                        }
                    }
                }
            ],
            "responses": {
                "201": {
                    "description": "User is logged in.",
                    "headers":{  
                        "Authorization":{
                            "type":"string",
                            "format":"Bearer",
                            "description":"token of authenticated user with format like 'Bearer xxxxx'"
                        }
                    }
                },
                "400": {
                    "description": "User could not be logged in.",
                    "schema":{
                      "$ref":"#/definitions/ApiErrorResponse"
                    }   
                }
                
            }
        }
    },
    "/auth/logout": {
        "get": {
            "operationId":"logoutUser",
            "tags": ["Authentication"],
            "summary":"Logout authenticated user who has token in heeader",
            "produces":[],
            "headers":[{  
                "Authorization":{
                    "type":"string",
                    "format":"Bearer",
                    "description":"token of authenticated user with format like 'Bearer xxxxx'"
                }
            }],
            "responses": {
                "200": {
                    "description": "User was succesfully logged out."
                },
                "401": {
                    "description": "User could not be logged out.",
                    "schema":{
                      "$ref":"#/definitions/ApiErrorResponse"
                    }   
                }
            }
        }
    },
    "/user": {
      "get":{
        "operationId":"getAuthenticatedUser",
        "tags":["Users"],
        "summary":"Returns authenticated user who has token in header.",
        "parameters":[
            {
                "name": "Authorization",
                "in": "header",
                "description": "User token that given with login. (Authorization: Bearer xxxxx )"
          }
        ],
        "responses": {
            "200": {
                "description": "User was successfully fetched.",
                "schema":{
                  "$ref":"#/definitions/ApiUserResponse"
                }   
            },
            "404": {
                "description": "User could not be found.",
                "schema":{
                  "$ref":"#/definitions/ApiErrorResponse"
                }   
            }
        }
      }
    },
    "/user/follow":{
      "post":{
        "operationId":"followUser",
        "tags":["Users"],
        "summary":"Follow to user with authenticated user.",
        "parameters":[
            {
                "name": "Authorization",
                "in": "header",
                "description": "User token that given with login. (Authorization: Bearer xxxxx )"
          },
          {
            "name": "followingId",
            "in": "body",
            "description":"User id that will be followed by authenticated user."
          }
        ],
        "responses": {
            "200": {
                "description": "User was successfully followed."
            },
            "400": {
                "description": "User could not be followed.",
                "schema":{
                  "$ref":"#/definitions/ApiErrorResponse"
                }   
            }
        }
      }
    },
    "/user/unfollow": {
      "post":{
        "operationId":"unfollowUser",
        "tags":["Users"],
        "summary":"Unfollow to user with authenticated user.",
        "parameters":[
            {
                "name": "Authorization",
                "in": "header",
                "description": "User token that given with login. (Authorization: Bearer xxxxx )"
          },
          {
            "name": "followingId",
            "in": "body",
            "description":"User id that will be unfollowed by authenticated user."
          }
        ],
        "responses": {
            "200": {
                "description": "User was successfully unfollowed."
            },
            "400": {
                "description": "User could not be unfollowed.",
                "schema":{
                  "$ref":"#/definitions/ApiErrorResponse"
                }   
            }
        }
      }
    }
  },
  "definitions": {
    "User": {
        "required": [
            "Username",
            "Password",
            "Fullname"
        ],
        "properties": {
            "_id": {
                "type": "string",
                "uniqueItems": true
            },
            "Username": {
                "type": "string"
            },
            "Fullname":{
                "type": "string"
            },
            "Contact": {
                "required": [
                    "Email"
                ],
                "properties": {
                    "Email": {
                        "type": "string"
                    },
                    "Phone": {
                        "type": "string"
                    }
                }
            },
            "Following":{
                    "type":"array"
            },
            "Follower":{
                    "type":"array"
            }
        }
    },
    "UserToRegister": {
        "required": [
            "Username",
            "Password",
            "Fullname"
        ],
        "properties": {
            "Username": {
                "type": "string"
            },
            "Password": {
                "type": "string"
            },
            "Fullname":{
                "type": "string"
            },
            "Contact": {
                "required": [
                    "Email"
                ],
                "properties": {
                    "Email": {
                        "type": "string"
                    },
                    "Phone": {
                        "type": "string"
                    }
                }
            }
        }
    },
    "Credentials":{
        "required":[
            "Username",
            "Password"
        ],
        "properties":{
            "Username": {
                "type": "string"
            },
            "Password": {
                "type":"string"
            }
        }                   
    },
    "ApiErrorResponse": {
        "properties":{
          "error":{
            "type":"string"
          }
        }
    },
    "ApiUserResponse": {
        "properties":{
          "result":{
            "type":"object",
            "$ref":"#/definitions/User"
        }
      }
    }
  }
}